<button
  pButton
  class="p-button-rounded"
  icon="pi pi-plus"
  (click)="openAddItemDialog()"
></button>

<form [formGroup]="form">
  <ng-container formArrayName="items">
    <div
      *ngFor="let item of itemsForm.controls; let i = index"
      [formGroupName]="i"
    >
      <div class="header">
        <div class="description">
          {{ bill.items[i].description }}
        </div>
        <div class="price">Â£{{ bill.items[i].cost }}</div>
      </div>
      <div formArrayName="sharedBy" class="sharedBy-grid">
        <div
          class="p-mb-2"
          [ngClass]="{ 'justify-self-right': j % 2 === 1 }"
          *ngFor="let sharedBy of sharedByForm(i).controls; let j = index"
          [formGroupName]="j"
        >
          <label class="p-mr-2" *ngIf="j % 2 === 1">{{
            bill.items[i].sharedBy[j].user
          }}</label>
          <p-inputSwitch
            formControlName="settled"
            pTooltip="Can't edit the original payer of the item"
            tooltipPosition="top"
          ></p-inputSwitch>
          <label class="p-ml-2" *ngIf="j % 2 === 0">{{
            bill.items[i].sharedBy[j].user
          }}</label>
        </div>
      </div>
      <hr />
    </div>
  </ng-container>
</form>

<p-dialog
  header="Add Item"
  [(visible)]="displayAddItemDialog"
  [style]="{ width: '100%' }"
>
  <bc-add-item
    [users]="bill.usersArray"
    (addItem)="
      addItem.emit({ newItem: $event, bill: bill }); closeAddItemDialog()
    "
  ></bc-add-item>
</p-dialog>
